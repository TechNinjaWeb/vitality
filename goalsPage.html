<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>Bootstrap, from Twitter</title>
  <!--<meta name="viewport" content="width=device-width, initial-scale=1.0" />-->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="description" content="" />
  <meta name="author" content="" />
  <!-- Le styles -->
  <link data-require="bootstrap-css" data-semver="3.3.1" rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" />
  <link data-require="bootstrap@*" data-semver="3.3.5" rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" />
  <link data-require="bootstrap@*" data-semver="3.3.5" rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootswatch/3.3.5/cosmo/bootstrap.min.css" />
  <link data-require="bootstrap@*" data-semver="3.3.5" rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="style.css">
  <!--<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>-->
  <script type="text/javascript" src="http://www.parsecdn.com/js/parse-latest.js"></script>

  <link href="style.css" rel="stylesheet" />
  <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  <!-- Le fav and touch icons -->
  <!--<link rel="shortcut icon" href="images/favicon.ico" />-->
  <link rel="apple-touch-icon" href="images/apple-touch-icon.png" />
  <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png" />
  <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png" />
  <!-- Le javascript
    ================================================== -->
  <script data-require="jquery" data-semver="2.1.4" src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
  <script data-require="bootstrap" data-semver="3.3.5" src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script src="script.js"></script>
</head>

<body id="goalsPage">
  <div class="page-container">
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="header-container container">
        <div class="left-icon col-xs-4"><a href="index.html"><i class="fa fa-lg fa-home"></i></a></div>
        <div class="title col-xs-4">
          <div class="nav-title text-center">Goals List</div>
        </div>
        <div class="right-icon col-xs-4 text-right"><a href="/createGoals.html"><i class="fa fa-lg fa-plus"></a></i>
        </div>
      </div>
    </nav>
    <div class="heading col-xs-12">
      <h2 class="heading-title text-center">Review Your Goals or <br>Create New Ones</h2>
    </div>
    <div class="page-content container">
      <table class="goal-list table small-container">
        <thead class="table-head">
          <tr>
            <th>Goal</th>
            <th class="text-right">% of Goal</th>
          </tr>
        </thead>
        <tbody class="table-body">
        </tbody>
      </table>
    </div>
  </div>
  <script type="text/javascript">
    var table = document.getElementsByClassName('table-body');
    var conditions = [{
      condition: "equalTo",
      col: "userName",
      val: window.commands.userName
    }];
    var goals = window.commands.queryParse('Goals', 'find', conditions);
        goals.then(function(res){
          // console.log("RESPONSE FROM FIRST CHAIN", res);
          var data = Array.prototype.slice.call(res).reduce(function(p,c,i,a){
            var d = {res: c, data: c.attributes};
            // console.log("RES", c, "DATA", d);
            p[c.id] = c.attributes;
            return p;
          }, {});
          return buildTable(table, data);;
    });

    // console.log("GOALS", goals);
    
    function buildTable(table, data) {
      console.log("TABLE", table, "DATA", data);
      // console.log(["Activity List", al], ["Type", typeof al], ["Is Array?", Array.isArray(al)]);
      for (var prop in data) {
        console.log("ELEMENT", data[prop]);
        var tmp = [{item: "Some Activity", 
          instructions: "Some Bullet Points", 
          type: 1,
          trackBy: 2
       }];
        var d = data[prop];
        var goals = document.createElement('tr');
        goals.className = "goals-list";
        
        console.log("EACH DATA", d);
        var goal = document.createElement('td');
            goal.className = "goal";
            goal.data = data;
            goal.innerHTML = "TBA GETSTRING FUNCTION";
        console.log("Get String",  getTypeAndSendString("fitness"));
    
        goals.appendChild(goal);
    
        table[0].appendChild(goals);
    
        // console.log(["Table", table], ["tr", tr], ["instructions", e.instructions]);
        // console.log("This is Table tr To Add", tr);
    
      }
    }
    function createAndAppendTr(table, type) {
       var tr = document.createElement('tr');
       var td = document.createElement('td');
           // DETERMINE NUMBER OR VERB TYPE AND BUILD
           td.innerHTML = getTypeAndSendString(type);
           td.className = "table-style";
       var i = document.createElement('i');
           i.className = "fa fa-lg fa-ban";
       var a = document.createElement('a');
           a.className = "delete-btn";
           a.addEventListener("click", removeBtn);
       var del = document.createElement('td');
           del.className = "text-right";
           
       // Add args[2] settings to TD
       var args = Array.prototype.slice.call(arguments);
           !!args[2] ? Array.prototype.slice.call(args[2]).forEach(function(e){
              for (var prop in e) {
                 td[prop] = e[prop];
              }
           }) : null;
           // Add Icon to Anchor
           a.appendChild(i);
           // Add Anchor to Delete TD
           del.appendChild(a);
           // Add Table Data
           tr.appendChild(td);
           tr.appendChild(del);
           table.appendChild(tr);
           
       function removeBtn(ev) {
          var tr = ev.target.parentNode.parentNode.parentNode;
          console.log("REMOVING", tr);
          tr.remove();
       }
    }
    function getTypeAndSendString(type) {
       // ARGS = TYPE, ARRAY, OBJECT
       // Second argument can be activities list
       var args = Array.prototype.slice.call(arguments);
       var tempActivities = [{item: "Some Activity", 
          instructions: "Some Bullet Points", 
          type: 1,
          trackBy: 2
       }, {item: "Some Other Activity", 
          instructions: "Some More Bullet Points", 
          type: 2,
          trackBy: 1
       }];
       var d = args[2] || {
          calories: ["eat", 2000, "calories"],
          weight: ["lose", 10, "pounds"],
          emotion: ["feel", 5, "on the Rate Me scale"],
          fitness: [args[1] || tempActivities, 3]
       };
       console.log("ARGUMENTS", args);
       var string = "I will ";
       if (type == "calories") {
          string = string+ "<span class='calories-verb'>"+ d[type][0] +"</span> ";
          string = string+ "<span class='calories-number'>"+ d[type][1] +" " + d[type][2] +"</span> per week";
          // console.log("STRING:", string);
       }
       if (type == "weight") {
          string = string+ "<span class='weight-verb'>"+ d[type][0] +"</span> ";
          string = string+ "<span class='weight-number'>"+ d[type][1] +" " + d[type][2] +"</span> per week";
          // console.log("STRING:", string);
       }
       if (type == "emotion") {
          string = string+ "<span class='emotion-verb'>"+ d[type][0] +"</span> ";
          string = string+ "an average of <span class='emotion-number'>"+ d[type][1] +" " + d[type][2] +"</span> per week";
          // console.log("STRING:", string);
       }
       if (type == "fitness") {
          string = string+ "do ";
          string = string+ "<span class='fitness-list'>"+ d[type][0][0].item +"</span> <span class='fitness-number'>" + d[type][1] +" times</span> per week";
          // console.log("STRING:", string);
       }
       return string;
    }
  </script>
</body>

</html>